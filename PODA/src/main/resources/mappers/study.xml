<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mappers">

	<insert id="createStudy" >
		INSERT INTO tbl_study
		(STUDY_NAME, STUDY_DESCRIPTION, LICENSE, IS_PUBLIC, AUTHORS, PUBLICATION, CONTACT, SITE_COLLECTED, CREATED_BY,CREATED_DATE,CREATED_IP)
		VALUE
		(#{studyName}, #{studyDesc}, #{license}, #{isPublic}, #{authors}, #{publication}, #{contact}, #{siteCollected}, "User", NOW(), #{createdIp}); 
	</insert>
	
	<select id="getStudyList" parameterType="Map" resultType="studyBO">
		SELECT
		ID as id,
		STUDY_NAME as studyName, 
		STUDY_DESCRIPTION as studyDesc,
		LICENSE as license,
		IS_PUBLIC as isPublic,
		if(IS_PUBLIC = 1, "Yes", "No") as isPublicString,
		AUTHORS as authors,
		PUBLICATION as publication,
		CONTACT as contact,
		SITE_COLLECTED as siteCollected,
		CREATED_BY as createdBy,
		CREATED_DATE as createdDate,
		CREATED_IP as createdIp
		FROM
		tbl_study
 		<if test="id!= null">
        	WHERE ID=#{id}
        </if>
	</select>
	
	<update id="updateStudy" parameterType="studybo">
		UPDATE tbl_study 
		SET
		STUDY_NAME = #{studyName}, 
		STUDY_DESCRIPTION = #{studyDesc},
		LICENSE = #{license},
		IS_PUBLIC = #{isPublic},
		AUTHORS = #{authors},
		PUBLICATION = #{publication},
		CONTACT = #{contact},
		SITE_COLLECTED = #{siteCollected},
		LAST_MODIFIED_BY = #{lastModifiedBy},
		LAST_MODIFIED_DATE = #{lastModifiedDate},
		LAST_MODIFIED_IP = #{lastModifiedIp}
		WHERE 
		ID = #{id}
	</update>
</mapper>