<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mappers">
	
	<insert id="insertTaskType" parameterType="taskTypeBO">
		INSERT INTO
		tbl_task_type
		(ID, TASK_TYPE, TASK_TYPE_DESCRIPTION, ENABLED, CREATED_BY, CREATED_DATE, CREATED_IP)
		VALUE
		(#{id},#{taskType},#{taskTypeDecription},#{isEnabled},#{createdBy},NOW(),#{createdFromIp})
	</insert>
	
	<select id="isValueExists" parameterType="Map" resultType="Integer">
		SELECT EXISTS(SELECT ${columnName} FROM ${tableName} WHERE
		${columnName}=#{columnValue}
	</select>
	
	<select id="isValueExistsUpdate" parameterType="Map" resultType="Integer">
		SELECT EXISTS(SELECT ${columnName} FROM ${tableName} WHERE
		${columnName}=#{columnValue} AND ID!=#{id}
	</select>
	
	<select id="getTaskTypeList" parameterType="Map" resultType="taskTypeBO">
		SELECT
		ID AS id,
		DEPARTMENT_NAME AS departmentName,
		ORG_ID AS orgId,
		CREATED_BY AS createdBy,
		CREATED_DATE AS createdDate
		FROM
		tbl_department
		WHERE ORG_ID=#{orgId}
		<if test="id!= null">
           AND ID=#{id}
        </if>
	</select>
	
	<update id="updateTaskType" parameterType="taskTypeBO">
		UPDATE tbl_task_type
		SET
		DEPARTMENT_NAME = #{departmentName},
		LAST_MODIFIED_BY = #{lastModifiedBy},
		LAST_MODIFIED_DATE = NOW(),
		LAST_MODIFIED_IP = #{lastModifiedFromIp}
		WHERE id = #{id}
	</update>
	
	<select id="isTaskTypeUsed" parameterType="Map" resultType="Integer">
		SELECT EXISTS(SELECT DISTINCT(DEPARTMENT_ID) FROM tbl_users WHERE
		DEPARTMENT_ID=#{id} AND ORG_ID=#{orgId})
	</select>
	
	<delete id="deleteTaskType" parameterType="Long">
	   DELETE FROM tbl_task_type
	   WHERE ID=#{id}
	</delete>
</mapper>